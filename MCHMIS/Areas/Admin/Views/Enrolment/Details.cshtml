@model MCHMIS.ViewModels.EnrolmentListDetailsViewModel

@{
    ViewData["Title"] = "Enrolment List Details";
    var tasks = User.FindFirst("UserRoles").Value;
}
@section buttons
    {
    @if (Model.Enrolment.ImportStatusId == null)
    {
        if (Model.Enrolment.StatusId == 1)
        {
            <a class="btn btn-primary modal-link" asp-action="SendForApproval" asp-route-option="generate" asp-route-id="@Model.Id">
                <span><i class="glyphicon glyphicon-ok-sign"></i> Send for Approval</span>
            </a>
        }
        else if (Model.Enrolment.StatusId == 2 && tasks.Contains("Approve Enrolment Lists"))
        {
            <a class="btn btn-primary modal-link" asp-action="Action" asp-route-option="generate" asp-route-id="@Model.Id">
                <span><i class="glyphicon glyphicon-ok-sign"></i> Approvals</span>
            </a>
        }

        else if (Model.Enrolment.StatusId == 3)
        {
            @if (tasks.Contains("Import Enrolment Lists"))
            {
                <a class="btn btn-primary" asp-action="Import" asp-route-id="@Model.Id">
                    <i class="fa fa-upload" aria-hidden="true"></i> Import
                </a>
            }
            @if (tasks.Contains("Download Enrolment List"))
            {
                <a class="btn btn-primary" asp-action="Export" asp-route-id="@Model.Id">
                    <i class="fa fa-file-excel-o" aria-hidden="true"></i> Download
                </a>
            }

        }
    }
    else
    {

        @if (Model.Enrolment.ImportStatusId == 1)
        {
            <a class="btn btn-primary modal-link" asp-action="SendForApproval" asp-route-option="import" asp-route-id="@Model.Id">
                <span><i class="glyphicon glyphicon-ok-sign"></i> Send for Approval</span>
            </a>
        }
        else if (Model.Enrolment.ImportStatusId == 2 && tasks.Contains("Approve Enrolment Lists"))
        {
            <a class="btn btn-primary modal-link" asp-action="Action" asp-route-option="import" asp-route-id="@Model.Id">
                <span><i class="glyphicon glyphicon-ok-sign"></i> Approvals</span>
            </a>
        }
        if (Model.Enrolment.ImportStatusId != null && tasks.Contains("Download Enrolment Mismatches"))
        {

            <a class="btn btn-primary" asp-action="ExportMismatch" asp-route-id="@Model.Id">
                <i class="fa fa-file-excel-o" aria-hidden="true"></i> Download Mismatch
            </a>

        }
    }
}
<form asp-action="AllowToEnroll">
<table id="table-filter" class="table table-striped table-bordered">
    <thead>
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.EnrolmentDetail.Household.UniqueId)
        </th>

        <th>
            @Html.DisplayNameFor(model => model.EnrolmentDetail.RecipientPhone)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.EnrolmentDetail.RecipientNames)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.EnrolmentDetail.CustomerName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.EnrolmentDetail.CustomerType)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.EnrolmentDetail.Status)
        </th>
        <th width="50">
            <input type="checkbox" name="ApproveAll" value="True" id="check-all" />
        </th>
    </tr>
    </thead>
    <tbody>
    @foreach (var item in Model.EnrolmentDetails)
    {
        <tr class="@Html.DisplayFor(modelItem => item.Status.Name)">

            <td>
                @Html.DisplayFor(modelItem => item.Household.UniqueId)
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.RecipientPhone)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.RecipientNames)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.CustomerName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.CustomerType)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Status.Name)
            </td>
            <td>
                @if (item.Status.Name.Equals("Names Mismatch") || item.Status.Name.Equals("Validated"))
                {
                    <input type="checkbox" name="Ids[]" value="@item.Id" />
                }
            </td>
        </tr>
    }
    @*<tr>
            <td colspan="5"><strong>Total</strong></td>
            <td>@Model.EnrolmentDetails.Count()</td>
        </tr>*@
    </tbody>
</table>
<hr/>
<div class="col-md-4 pull-right action-cont">
    <input type="hidden" asp-for="Id" />
    <div class="col-md-12 pull-right">
        <label class="control-label">With Selected</label>
        <span class="field-validation-valid action-error text-danger">*Select an Action.</span>
        @Html.DropDownList("ActionId", null, htmlAttributes: new { @class = "form-control" })
    </div>
    <div class="col-md-12">
        <input type="submit" value="Save" class="btn pull-right btn-inline btn-primary" />
    </div>
</div>
</form>
<a asp-action="Lists" class="btn btn-danger glyphicon glyphicon-step-backward pull-left"> Back</a>